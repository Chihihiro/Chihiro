from engine import *
fd="'JR000056',	'JR000063',	'JR000067',	'JR000082',	'JR000109',	'JR000117',	'JR000119',	'JR000120',	'JR000122',	'JR000132',	'JR000135',	'JR000144',	'JR000154',	'JR000176',	'JR000193',	'JR000194',	'JR000198',	'JR000200',	'JR000228',	'JR000229',	'JR000248',	'JR000255',	'JR000271',	'JR000283',	'JR000297',	'JR000304',	'JR000307',	'JR000315',	'JR000320',	'JR000329',	'JR000346',	'JR000355',	'JR000398',	'JR000406',	'JR000412',	'JR000414',	'JR000433',	'JR000476',	'JR000479',	'JR000526',	'JR000547',	'JR000552',	'JR000806',	'JR001246',	'JR001253',	'JR001399',	'JR001467',	'JR001819',	'JR001821',	'JR001953',	'JR002008',	'JR002185',	'JR002725',	'JR002984',	'JR002986',	'JR003016',	'JR003017',	'JR003018',	'JR003031',	'JR003034',	'JR003036',	'JR003037',	'JR003038',	'JR003040',	'JR003053',	'JR003067',	'JR003115',	'JR003149',	'JR003171',	'JR003209',	'JR003210',	'JR003241',	'JR003269',	'JR003280',	'JR003307',	'JR003361',	'JR003380',	'JR003418',	'JR003460',	'JR003491',	'JR003492',	'JR003496',	'JR003530',	'JR003543',	'JR003545',	'JR003611',	'JR003653',	'JR003654',	'JR003655',	'JR003665',	'JR003667',	'JR003682',	'JR003686',	'JR003710',	'JR003727',	'JR003732',	'JR003748',	'JR003749',	'JR003781',	'JR003839',	'JR003843',	'JR003845',	'JR003846',	'JR003847',	'JR003850',	'JR003855',	'JR003860',	'JR003911',	'JR003921',	'JR003956',	'JR003971',	'JR003982',	'JR004052',	'JR004053',	'JR004060',	'JR004064',	'JR004075',	'JR004103',	'JR004107',	'JR004121',	'JR004197',	'JR004217',	'JR004249',	'JR004251',	'JR004255',	'JR004256',	'JR004259',	'JR004260',	'JR004279',	'JR004298',	'JR004311',	'JR004312',	'JR004317',	'JR004318',	'JR004380',	'JR004389',	'JR004423',	'JR004456',	'JR004476',	'JR004514',	'JR004560',	'JR004618',	'JR004777',	'JR004784',	'JR004830',	'JR004895',	'JR004979',	'JR005027',	'JR005058',	'JR005059',	'JR005279',	'JR005503',	'JR005646',	'JR005714',	'JR005759',	'JR005890',	'JR006036',	'JR006202',	'JR006433',	'JR006438',	'JR006593',	'JR006658',	'JR009525',	'JR009584',	'JR009612',	'JR009733',	'JR009738',	'JR009920',	'JR009922',	'JR010116',	'JR010171',	'JR010295',	'JR010328',	'JR010457',	'JR010478',	'JR010789',	'JR010906',	'JR011016',	'JR011058',	'JR011387',	'JR011423',	'JR011544',	'JR011618',	'JR012033',	'JR012072',	'JR012099',	'JR012102',	'JR012126',	'JR012132',	'JR012133',	'JR012137',	'JR012150',	'JR012151',	'JR012171',	'JR012174',	'JR012179',	'JR012212',	'JR012218',	'JR012231',	'JR012244',	'JR012275',	'JR012293',	'JR012301',	'JR012331',	'JR012341',	'JR012344',	'JR012354',	'JR012356',	'JR012364',	'JR012376',	'JR012378',	'JR012398',	'JR012402',	'JR012434',	'JR012447',	'JR012465',	'JR012497',	'JR012509',	'JR012512',	'JR012526',	'JR012529',	'JR012601',	'JR012602',	'JR012613',	'JR012628',	'JR012641',	'JR012704',	'JR012763',	'JR012772',	'JR012778',	'JR012785',	'JR012812',	'JR012824',	'JR012833',	'JR012870',	'JR012885',	'JR012967',	'JR012970',	'JR013045',	'JR013059',	'JR013065',	'JR013069',	'JR013163',	'JR013222',	'JR013324',	'JR013345',	'JR013353',	'JR013403',	'JR013438',	'JR013468',	'JR013478',	'JR013600',	'JR013654',	'JR013683',	'JR013869',	'JR013879',	'JR013913',	'JR014205',	'JR014395',	'JR014662',	'JR014794',	'JR014796',	'JR014836',	'JR015037',	'JR015093',	'JR015260',	'JR015322',	'JR015494',	'JR015648',	'JR016026',	'JR016163',	'JR016171',	'JR016187',	'JR016265',	'JR016402',	'JR016403',	'JR016421',	'JR016532',	'JR016654',	'JR016782',	'JR016857',	'JR016939',	'JR016989',	'JR017132',	'JR017262',	'JR017459',	'JR017476',	'JR017641',	'JR017759',	'JR017846',	'JR017894',	'JR017916',	'JR018081',	'JR018185',	'JR018270',	'JR018663',	'JR018749',	'JR018802',	'JR018820',	'JR019054',	'JR019151',	'JR019284',	'JR019318',	'JR019399',	'JR019446',	'JR019509',	'JR019584',	'JR019603',	'JR019630',	'JR019952',	'JR020117',	'JR020287',	'JR020314',	'JR020435',	'JR020613',	'JR020804',	'JR021165',	'JR021574',	'JR021802',	'JR022095',	'JR022110',	'JR022204',	'JR022205',	'JR022275',	'JR022876',	'JR023091',	'JR023289',	'JR023332',	'JR023401',	'JR023429',	'JR023572',	'JR023573',	'JR023575',	'JR023603',	'JR023656',	'JR023695',	'JR023705',	'JR023759',	'JR023765',	'JR023767',	'JR023818',	'JR024074',	'JR024148',	'JR024219',	'JR024318',	'JR024325',	'JR024441',	'JR024473',	'JR024561',	'JR024562',	'JR024564',	'JR024716',	'JR025151',	'JR025166',	'JR025420',	'JR025522',	'JR025685',	'JR025988',	'JR026102',	'JR026189',	'JR026597',	'JR026802',	'JR027117',	'JR027126',	'JR027129',	'JR027131',	'JR027133',	'JR027176',	'JR027179',	'JR027295',	'JR027297',	'JR027358',	'JR027614',	'JR027686',	'JR027692',	'JR027702',	'JR027799',	'JR027830',	'JR027833',	'JR028509',	'JR029024',	'JR029463',	'JR029926',	'JR029941',	'JR030795',	'JR031825',	'JR033762',	'JR034137',	'JR035521',	'JR036069',	'JR038272',	'JR038575',	'JR040269',	'JR040524',	'JR041724',	'JR043554',	'JR044705',	'JR044804',	'JR045011',	'JR045697',	'JR046133',	'JR046368',	'JR046559',	'JR047261',	'JR048187',	'JR048237',	'JR049230',	'JR049342',	'JR050023',	'JR050177',	'JR051924',	'JR052366',	'JR052625',	'JR053119',	'JR053843',	'JR055312',	'JR055651',	'JR056213',	'JR056699',	'JR056940',	'JR057308',	'JR060349',	'JR062635',	'JR062736',	'JR063530',	'JR064210',	'JR064468',	'JR066478',	'JR066857',	'JR067118',	'JR067798',	'JR068266',	'JR068384',	'JR069765',	'JR069864',	'JR069900',	'JR069901',	'JR069909',	'JR070376',	'JR070464',	'JR070565',	'JR071235',	'JR071797',	'JR072531',	'JR072670',	'JR072719',	'JR072792',	'JR073037',	'JR074024',	'JR074669',	'JR076041',	'JR078106',	'JR078191',	'JR078280',	'JR078368',	'JR078370',	'JR078401',	'JR078550',	'JR078633',	'JR078639',	'JR078836',	'JR079132',	'JR079469',	'JR079797',	'JR079806',	'JR079823',	'JR079861',	'JR080221',	'JR080882',	'JR081289',	'JR081884',	'JR081897',	'JR082141',	'JR082146',	'JR082467',	'JR082548',	'JR082553',	'JR082554',	'JR082573',	'JR082588',	'JR082590',	'JR082591',	'JR082592',	'JR082599',	'JR082602',	'JR082639',	'JR082667',	'JR082670',	'JR082671',	'JR082674',	'JR082676',	'JR082679',	'JR082680',	'JR082681',	'JR082686',	'JR082700',	'JR082704',	'JR082728',	'JR082738',	'JR082741',	'JR082747',	'JR082754',	'JR082759',	'JR082761',	'JR082773',	'JR082776',	'JR082781',	'JR082787',	'JR082792',	'JR082877',	'JR082882',	'JR082907',	'JR082927',	'JR082934',	'JR082941',	'JR082955',	'JR082965',	'JR082982',	'JR082986',	'JR083006',	'JR083054',	'JR083096',	'JR083124',	'JR083136',	'JR083164',	'JR083166',	'JR083178',	'JR083285',	'JR083286',	'JR083287',	'JR083320',	'JR083345',	'JR083361',	'JR083701',	'JR083727',	'JR083755',	'JR083950',	'JR084032',	'JR084125',	'JR084129',	'JR084237',	'JR084284',	'JR084884',	'JR085063',	'JR085187',	'JR085531',	'JR085779',	'JR086185',	'JR086257',	'JR086568',	'JR086648',	'JR086909',	'JR087311',	'JR087702',	'JR087704',	'JR087705',	'JR088438',	'JR088524',	'JR088533',	'JR088673',	'JR088840',	'JR088841',	'JR088919',	'JR088983',	'JR088984',	'JR089103',	'JR089181',	'JR089183',	'JR089188',	'JR089362',	'JR089445',	'JR090133',	'JR090330',	'JR090353',	'JR090448',	'JR090461',	'JR090464',	'JR090471',	'JR090481',	'JR090488',	'JR090554',	'JR090580',	'JR090595',	'JR090621',	'JR090645',	'JR090649',	'JR090655',	'JR090687',	'JR090689',	'JR090691',	'JR090735',	'JR090870',	'JR090872',	'JR090987',	'JR091051',	'JR091052',	'JR091053',	'JR091160',	'JR091170',	'JR091210',	'JR091224',	'JR091330',	'JR091350',	'JR091403',	'JR091405',	'JR091409',	'JR091451',	'JR091462',	'JR091464',	'JR091491',	'JR091500',	'JR091503',	'JR091506',	'JR091508',	'JR091510',	'JR091559',	'JR091563',	'JR091597',	'JR091619',	'JR091691',	'JR091736',	'JR091762',	'JR091764',	'JR091767',	'JR091768',	'JR091773',	'JR091778',	'JR092169',	'JR092171',	'JR092172',	'JR092190',	'JR092212',	'JR092241',	'JR092244',	'JR092281',	'JR092287',	'JR092330',	'JR092334',	'JR092339',	'JR092437',	'JR092488',	'JR092569',	'JR092594',	'JR092603',	'JR092604',	'JR092606',	'JR092607',	'JR092831',	'JR092940',	'JR092975',	'JR093208',	'JR093249',	'JR093253',	'JR093280',	'JR093288',	'JR093290',	'JR093313',	'JR093420',	'JR093442',	'JR093605',	'JR093780',	'JR093798',	'JR093865',	'JR093914',	'JR093936',	'JR094005',	'JR094043',	'JR094095',	'JR094097',	'JR094103',	'JR094124',	'JR094137',	'JR094140',	'JR094181',	'JR094203',	'JR094212',	'JR094244',	'JR094247',	'JR094347',	'JR094349',	'JR094710',	'JR095021',	'JR095268',	'JR096107',	'JR096139',	'JR096432',	'JR096820',	'JR096836',	'JR097321',	'JR097921',	'JR098264',	'JR098537',	'JR098771',	'JR098773',	'JR098775',	'JR098873',	'JR098889',	'JR098986',	'JR098988',	'JR098989',	'JR098994',	'JR099008',	'JR099089',	'JR099093',	'JR099295',	'JR099689',	'JR099850',	'JR099860',	'JR099943',	'JR100045',	'JR100047',	'JR100135',	'JR100184',	'JR100274',	'JR100311',	'JR100349',	'JR100429',	'JR100721',	'JR100745',	'JR100764',	'JR101027',	'JR101252',	'JR101626',	'JR101656',	'JR101699',	'JR101731',	'JR101915',	'JR101927',	'JR101932',	'JR102059',	'JR102083',	'JR102111',	'JR102178',	'JR102451',	'JR102702',	'JR103015',	'JR103121',	'JR103125',	'JR103430',	'JR103502',	'JR103684',	'JR104223',	'JR105232',	'JR105541',	'JR105640',	'JR106199',	'JR106232',	'JR106347',	'JR106366',	'JR108325',	'JR112985',	'JR113830',	'JR114073',	'JR114094',	'JR114248',	'JR114278',	'JR114428',	'JR114493',	'JR114589',	'JR114752',	'JR115053',	'JR115205',	'JR115496',	'JR115521',	'JR116276',	'JR116388',	'JR116403',	'JR116404',	'JR116422',	'JR116599',	'JR117095',	'JR117573',	'JR117601',	'JR117956',	'JR118031',	'JR118339',	'JR118653',	'JR118716',	'JR118717',	'JR118996',	'JR119016',	'JR119091',	'JR119258',	'JR119578',	'JR119759',	'JR119948',	'JR120043',	'JR120054',	'JR120055',	'JR120378',	'JR120562',	'JR120573',	'JR120578',	'JR120584',	'JR120594',	'JR120595',	'JR120622',	'JR120631',	'JR121279',	'JR121280',	'JR121397',	'JR121402',	'JR122681',	'JR122725',	'JR122940',	'JR126131',	'JR126488',	'JR126678',	'JR127411',	'JR128063',	'JR128086',	'JR128294',	'JR128618',	'JR128622',	'JR128643',	'JR128646',	'JR128653',	'JR128667',	'JR128696',	'JR128698',	'JR128706',	'JR128707',	'JR128719',	'JR128780',	'JR128794',	'JR128796',	'JR128798',	'JR130710',	'JR130731',	'JR130786',	'JR130788',	'JR130848',	'JR131163',	'JR131225',	'JR131305',	'JR131747',	'JR131805',	'JR131808',	'JR131876',	'JR132067',	'JR132441',	'JR132531',	'JR132574',	'JR132885',	'JR133949',	'JR134248',	'JR134250',	'JR134253',	'JR134500',	'JR134673',	'JR135119',	'JR135899',	'JR135923',	'JR135986',	'JR136170',	'JR136438',	'JR137409',	'JR137562',	'JR137626',	'JR137712',	'JR137747',	'JR137750',	'JR137850',	'JR137956',	'JR138013',	'JR138014',	'JR138015',	'JR138016',	'JR138182',	'JR138218',	'JR138432',	'JR138838',	'JR139075',	'JR140367',	'JR141511',	'JR141702',	'JR141724',	'JR142609',	'JR143456',	'JR147154',	'JR147155',	'JR147158',	'JR147160',	'JR147162',	'JR147458',	'JR150309',	'JR150592',	'JR150621',	'JR151255',	'JR153147',	'JR155122',	'JR159167'"
df=pd.read_sql("select fund_id,nav,added_nav,statistic_date from fund_nv_data_standard where fund_id in ({})".format(fd),engine_base)


df["after_tax_bonus_add"]=df["added_nav"]-df["nav"]

df["split_ratio_add"]=df["added_nav"]/df["nav"]

df['after_tax_bonus_add'] = df['after_tax_bonus_add'].apply(lambda x: '%.4f' % x)
df['split_ratio_add'] = df['split_ratio_add'].apply(lambda x: '%.4f' % x)

dataframe=df
is_checked = input("输入1来确认入库\n")
if is_checked == "1":
    engine_bt = create_engine("mysql+pymysql://{}:{}@{}:{}/{}".format('root','','localhost',3306,'base.test', ), connect_args={"charset": "utf8"},echo=True,)
    to_sql("fund_nv_data_standard", engine_bt, dataframe, type="update")
else:
    pass